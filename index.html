<!DOCTYPE html>
<html>
<head>
  <title>User Management</title>
</head>
<body>
<h1>User List</h1>
<ul id="userList"></ul>

<h2>Register New User</h2>
<form id="registerForm">
  Username: <input type="text" id="username" required><br>
  Email: <input type="email" id="email" required><br>
  Password: <input type="password" id="password" required><br>
  Role: 
  <select id="role">
    <option value="student">Student</option>
    <option value="teacher">Teacher</option>
  </select><br>
  <button type="submit">Register</button>
</form>

<script>
const API_URL = 'http://localhost:5001/api/users';

// Fetch all users and display them (show role only or include email if you want)
function fetchUsers() {
  fetch(`${API_URL}/`)
    .then(res => res.json())
    .then(users => {
      const ul = document.getElementById('userList');
      ul.innerHTML = '';
      users.forEach((user, index) => {
        const li = document.createElement('li');
        // Show email and role
        li.textContent = `User ${index + 1}: ${user.email} - ${user.role}`;
        ul.appendChild(li);
      });
    });
}

// Handle user registration
document.getElementById('registerForm').addEventListener('submit', (e) => {
  e.preventDefault();
  const username = document.getElementById('username').value;
  const email = document.getElementById('email').value;
  const password = document.getElementById('password').value;
  const role = document.getElementById('role').value;

  fetch(`${API_URL}/register`, {
    method: 'POST',
    headers: {'Content-Type': 'application/json'},
    body: JSON.stringify({ username, email, password, role })
  })
  .then(res => res.json())
  .then(data => {
    alert(data.message || JSON.stringify(data));
    // Clear form fields
    document.getElementById('username').value = '';
    document.getElementById('email').value = '';
    document.getElementById('password').value = '';
    document.getElementById('role').value = 'student';
    fetchUsers(); // refresh the user list
  });
});

// Initial load
fetchUsers();
</script>
</body>
</html>